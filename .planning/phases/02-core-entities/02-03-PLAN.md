# Plan 02-03: Authentication & Layout

## Overview

Implement authentication system with Zustand store and create the main app layout with sidebar navigation.

## Prerequisites

- Plans 02-01, 02-02 complete
- UI components available

## Tasks

### 1. Create Auth Store

`stores/auth-store.ts` with Zustand + persist middleware:

- State: user, profile, isLoading
- Actions: initialize(), signIn(), signOut(), setProfile()
- Persist user/profile to localStorage
- Fetch user profile from `users` table on auth

### 2. Create UI Store

`stores/ui-store.ts`:

- State: sidebarOpen, toasts[]
- Actions: toggleSidebar(), addToast(), removeToast()

### 3. Create Login Page

`pages/auth/login.tsx`:

- Email/password form
- Form validation with Zod
- Error handling
- Redirect to dashboard on success
- Ross Built branding

### 4. Create Layout Components

**Sidebar** (`components/layout/sidebar.tsx`):
- Ross Built logo
- Navigation links with icons
- Active state highlighting
- Links: Dashboard, Calendar, Clients, Properties, Inspections, Work Orders, Billing, Vendors, Reports, Settings

**Header** (`components/layout/header.tsx`):
- Search bar (placeholder for now)
- User avatar dropdown
- Sign out option

**AppLayout** (`components/layout/app-layout.tsx`):
- Auth guard (redirect to login if not authenticated)
- Sidebar + Header + content area
- Uses Outlet for nested routes

**PageHeader** (`components/layout/page-header.tsx`):
- Reusable page header with title, description, action slot

### 5. Create Dashboard Page

`pages/dashboard/index.tsx`:

- Placeholder dashboard with welcome message
- Stats cards (placeholder data)
- Recent activity (placeholder)

### 6. Setup Routing

`App.tsx`:

- React Router setup
- Auth routes (/login)
- Protected routes with AppLayout
- Dashboard, clients, properties routes

### 7. Initialize Auth on App Load

Call `initialize()` in App.tsx useEffect to restore session.

## Files Created

```
src/
├── stores/
│   ├── auth-store.ts
│   └── ui-store.ts
├── pages/
│   ├── auth/
│   │   └── login.tsx
│   └── dashboard/
│       └── index.tsx
├── components/
│   └── layout/
│       ├── app-layout.tsx
│       ├── sidebar.tsx
│       ├── header.tsx
│       └── page-header.tsx
└── App.tsx (updated)
```

## Validation

- [ ] Login page displays with form
- [ ] Can log in with test user
- [ ] Sidebar navigation appears after login
- [ ] Active nav item highlighted
- [ ] User can sign out
- [ ] Unauthenticated users redirected to login
- [ ] Dashboard displays after login

## Estimated Duration

15-20 minutes
