---
phase: 05-templates-checklists
plan: 04
type: execute
wave: 3
depends_on: ["05-02"]
files_modified:
  - apps/admin/src/pages/settings/templates/index.tsx
  - apps/admin/src/pages/settings/templates/components/template-editor.tsx
  - apps/admin/src/App.tsx
autonomous: true
---

<objective>
Build the Template Management UI for viewing and editing inspection templates.

Purpose: Allow admins to customize inspection checklists for their organization.
Output: Templates settings page with template editor dialog.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Prior plan outputs:
@.planning/phases/05-templates-checklists/05-01-SUMMARY.md
@.planning/phases/05-templates-checklists/05-02-SUMMARY.md

Reference document:
@C:/Users/Jake/Downloads/home-care-os-docs/phase-05-templates-checklists.md (section 5.4)

Existing settings page pattern:
@C:/Users/Jake/home-care-os/apps/admin/src/pages/settings/pricing.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Templates page</name>
  <files>apps/admin/src/pages/settings/templates/index.tsx</files>
  <action>
Create Template Management page:

1. State: editing (template or null for new)

2. Use useInspectionTemplates() hook to fetch templates

3. Group templates by tier using reduce()

4. Page layout:
   - PageHeader: "Inspection Templates" / "Manage checklist templates for each inspection tier"
   - Action button: "New Template" opens TemplateEditor

5. For each tier (visual, functional, comprehensive, preventative):
   - Card with CardTitle showing tier name (capitalized)
   - List of templates for that tier
   - Each template row shows:
     - Name
     - Category badge (if exists)
     - Feature type badge (if exists)
     - Item count (from sections.reduce)
     - Edit button (opens TemplateEditor)

6. Empty state: "No templates for this tier" message

7. TemplateEditor dialog integration:
   - Pass template (or empty object for new)
   - open/onOpenChange state
   - onSave invalidates query and closes

Follow structure from phase-05-templates-checklists.md section 5.4.
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>Templates page renders grouped templates with edit functionality</done>
</task>

<task type="auto">
  <name>Task 2: Create Template Editor dialog</name>
  <files>apps/admin/src/pages/settings/templates/components/template-editor.tsx</files>
  <action>
Create TemplateEditor component as a Dialog/Sheet:

1. Props: { template, open, onOpenChange, onSave }

2. Use react-hook-form with inspectionTemplateSchema

3. Form sections:
   a. Basic info:
      - Name (text input, required)
      - Description (textarea)
      - Tier (select: visual, functional, comprehensive, preventative)
      - Category (select: exterior, interior, hvac, pool, etc. or empty)
      - Feature type (select: pool, dock, generator, etc. or empty)
      - Estimated minutes (number)

   b. Sections editor:
      - List of sections (name, order)
      - Add section button
      - For each section: list of items
      - Add item button per section
      - Item fields: text, type, photo_required, photo_recommended, help_text

4. Use useCreateInspectionTemplate or useUpdateInspectionTemplate based on whether template.id exists

5. Submit handler:
   - Call appropriate mutation
   - Show toast on success/error
   - Call onSave()

6. Keep UI simple for now - basic form, not full drag-and-drop builder
   - Can enhance later if needed

Dialog should be large (Sheet side="right" or Dialog with larger size).
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>Template editor dialog allows creating and editing templates</done>
</task>

<task type="auto">
  <name>Task 3: Add route and navigation</name>
  <files>apps/admin/src/App.tsx</files>
  <action>
Add Templates page to routing:

1. Import TemplatesPage from '@/pages/settings/templates'

2. Add route:
   - Path: /settings/templates
   - Element: <TemplatesPage />

3. Add navigation link in sidebar (if not exists):
   - Under Settings section
   - Label: "Templates"
   - Icon: ClipboardList or FileText
  </action>
  <verify>Route accessible at /settings/templates</verify>
  <done>Templates settings route added to router and sidebar</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd apps/admin && npm run build` succeeds
- [ ] Templates page accessible at /settings/templates
- [ ] Can view templates grouped by tier
- [ ] Can open template editor
</verification>

<success_criteria>
- All tasks completed
- No TypeScript errors
- Template management UI functional
</success_criteria>

<output>
After completion, create `.planning/phases/05-templates-checklists/05-04-SUMMARY.md`
</output>
