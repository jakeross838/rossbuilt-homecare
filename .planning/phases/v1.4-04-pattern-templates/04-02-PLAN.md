---
phase: v1.4-04-pattern-templates
plan: 02
type: execute
wave: 2
depends_on: []
files_modified:
  - apps/admin/src/components/shared/loading-state.tsx
  - apps/admin/src/components/shared/error-state.tsx
  - apps/admin/src/components/shared/action-button.tsx
  - apps/admin/src/components/shared/index.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "LoadingState component displays centered spinner with optional message"
    - "ErrorState component displays error message with retry button"
    - "ActionButton shows loading state and disables during mutations"
    - "All components follow shadcn/ui design patterns"
  artifacts:
    - path: "apps/admin/src/components/shared/loading-state.tsx"
      provides: "Full-page/section loading state"
      exports: ["LoadingState"]
    - path: "apps/admin/src/components/shared/error-state.tsx"
      provides: "Error display with retry"
      exports: ["ErrorState"]
    - path: "apps/admin/src/components/shared/action-button.tsx"
      provides: "Button with loading state for mutations"
      exports: ["ActionButton"]
    - path: "apps/admin/src/components/shared/index.ts"
      provides: "Barrel export for shared components"
      exports: ["LoadingState", "ErrorState", "ActionButton", "EmptyState", "LoadingSpinner"]
  key_links:
    - from: "apps/admin/src/components/shared/action-button.tsx"
      to: "@/components/ui/button"
      via: "import Button"
      pattern: "import.*Button.*from.*@/components/ui/button"
    - from: "apps/admin/src/components/shared/error-state.tsx"
      to: "@/components/ui/button"
      via: "import Button for retry"
      pattern: "Button.*onClick.*retry"
---

<objective>
Create UI state components for consistent loading, error, and button states across all pages.

Purpose: Implement SYNC-07 (Consistent Button States) and SYNC-08 (Standard Data States) by creating reusable components that ensure every page handles loading/error/empty states consistently.

Output: Three new shared components (LoadingState, ErrorState, ActionButton) plus barrel export.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS-v1.4.md

Reference existing components:
@apps/admin/src/components/shared/loading-spinner.tsx - Existing spinner
@apps/admin/src/components/shared/empty-state.tsx - Existing empty state
@apps/admin/src/components/shared/error-boundary.tsx - Error boundary pattern
@apps/admin/src/components/ui/button.tsx - shadcn/ui Button
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create LoadingState component (SYNC-08.1)</name>
  <files>apps/admin/src/components/shared/loading-state.tsx</files>
  <action>
Create `src/components/shared/loading-state.tsx`:

```typescript
import { LoadingSpinner } from './loading-spinner'
import { cn } from '@/lib/utils'

interface LoadingStateProps {
  /** Loading message to display below spinner */
  message?: string
  /** Size variant */
  size?: 'sm' | 'md' | 'lg'
  /** Additional CSS classes */
  className?: string
  /** Full page height (min-h-[400px]) vs inline */
  fullPage?: boolean
}

/**
 * Standard loading state component
 *
 * Usage:
 *   if (isLoading) return <LoadingState message="Loading clients..." />
 *
 * For inline loading (smaller sections):
 *   <LoadingState size="sm" fullPage={false} />
 */
export function LoadingState({
  message = 'Loading...',
  size = 'md',
  className,
  fullPage = true,
}: LoadingStateProps) {
  return (
    <div
      className={cn(
        'flex flex-col items-center justify-center text-center',
        fullPage ? 'min-h-[400px] p-6' : 'py-8',
        className
      )}
      role="status"
      aria-label={message}
    >
      <LoadingSpinner size={size} className="mb-4" />
      {message && (
        <p className="text-sm text-muted-foreground">{message}</p>
      )}
    </div>
  )
}
```

Key requirements:
- Use existing LoadingSpinner component
- Support fullPage (default) and inline variants
- Include ARIA label for accessibility
- Match shadcn/ui design patterns (text-muted-foreground)
  </action>
  <verify>
- File exists at apps/admin/src/components/shared/loading-state.tsx
- TypeScript compiles: `cd apps/admin && npx tsc --noEmit`
- Exports LoadingState
  </verify>
  <done>LoadingState component created with spinner and optional message</done>
</task>

<task type="auto">
  <name>Task 2: Create ErrorState component (SYNC-08.2)</name>
  <files>apps/admin/src/components/shared/error-state.tsx</files>
  <action>
Create `src/components/shared/error-state.tsx`:

```typescript
import { AlertTriangle, RefreshCw } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { cn } from '@/lib/utils'

interface ErrorStateProps {
  /** Error title */
  title?: string
  /** Error message or Error object */
  error?: string | Error | null
  /** Retry handler - if provided, shows retry button */
  onRetry?: () => void
  /** Additional CSS classes */
  className?: string
  /** Full page height vs inline */
  fullPage?: boolean
}

/**
 * Standard error state component with retry button
 *
 * Usage:
 *   if (error) return <ErrorState error={error} onRetry={refetch} />
 *
 * With custom title:
 *   <ErrorState title="Failed to load data" error={error} onRetry={refetch} />
 */
export function ErrorState({
  title = 'Something went wrong',
  error,
  onRetry,
  className,
  fullPage = true,
}: ErrorStateProps) {
  // Extract error message from Error object or string
  const errorMessage = error
    ? typeof error === 'string'
      ? error
      : error.message
    : 'An unexpected error occurred. Please try again.'

  return (
    <div
      className={cn(
        'flex flex-col items-center justify-center text-center',
        fullPage ? 'min-h-[400px] p-6' : 'py-8',
        className
      )}
      role="alert"
    >
      <div className="mb-4 rounded-full bg-destructive/10 p-4">
        <AlertTriangle className="h-8 w-8 text-destructive" />
      </div>
      <h3 className="text-lg font-semibold">{title}</h3>
      <p className="mt-1 max-w-sm text-sm text-muted-foreground">
        {errorMessage}
      </p>
      {onRetry && (
        <Button
          variant="outline"
          onClick={onRetry}
          className="mt-4"
        >
          <RefreshCw className="mr-2 h-4 w-4" />
          Try Again
        </Button>
      )}
    </div>
  )
}
```

Key requirements:
- Match error-boundary.tsx design pattern
- Support Error object or string for error prop
- Retry button only shows when onRetry provided
- Include role="alert" for accessibility
- Use destructive color palette
  </action>
  <verify>
- File exists at apps/admin/src/components/shared/error-state.tsx
- TypeScript compiles: `cd apps/admin && npx tsc --noEmit`
- Exports ErrorState
  </verify>
  <done>ErrorState component created with retry button</done>
</task>

<task type="auto">
  <name>Task 3: Create ActionButton component (SYNC-07.1)</name>
  <files>apps/admin/src/components/shared/action-button.tsx</files>
  <action>
Create `src/components/shared/action-button.tsx`:

```typescript
import { forwardRef } from 'react'
import { Loader2 } from 'lucide-react'
import { Button, ButtonProps } from '@/components/ui/button'
import { cn } from '@/lib/utils'

export interface ActionButtonProps extends ButtonProps {
  /** Whether the action is in progress */
  isPending?: boolean
  /** Text to show while loading (defaults to "Loading...") */
  loadingText?: string
}

/**
 * Button component with built-in loading state for mutations
 *
 * Usage:
 *   <ActionButton
 *     isPending={mutation.isPending}
 *     loadingText="Saving..."
 *     onClick={() => mutation.mutate(data)}
 *   >
 *     Save Changes
 *   </ActionButton>
 *
 * Implements SYNC-07:
 * - SYNC-07.1: ActionButton component with isPending prop
 * - SYNC-07.2: disabled={isPending} when loading
 * - SYNC-07.3: Shows loading text while pending
 */
const ActionButton = forwardRef<HTMLButtonElement, ActionButtonProps>(
  ({ isPending, loadingText = 'Loading...', children, disabled, className, ...props }, ref) => {
    return (
      <Button
        ref={ref}
        disabled={disabled || isPending}
        className={cn(className)}
        {...props}
      >
        {isPending ? (
          <>
            <Loader2 className="mr-2 h-4 w-4 animate-spin" />
            {loadingText}
          </>
        ) : (
          children
        )}
      </Button>
    )
  }
)

ActionButton.displayName = 'ActionButton'

export { ActionButton }
```

Key requirements:
- Extend shadcn/ui Button with all its variants/sizes
- isPending prop controls loading state (SYNC-07.1)
- Automatically disabled when isPending (SYNC-07.2)
- Shows loading text while pending (SYNC-07.3)
- Use Loader2 icon with animate-spin for loading indicator
- Forward ref for form integration
  </action>
  <verify>
- File exists at apps/admin/src/components/shared/action-button.tsx
- TypeScript compiles: `cd apps/admin && npx tsc --noEmit`
- Exports ActionButton
  </verify>
  <done>ActionButton component created with loading state support</done>
</task>

<task type="auto">
  <name>Task 4: Create shared components barrel export</name>
  <files>apps/admin/src/components/shared/index.ts</files>
  <action>
Create `src/components/shared/index.ts` barrel export:

```typescript
/**
 * Shared Components Barrel Export
 *
 * Re-exports all shared components for convenient imports:
 *   import { LoadingState, ErrorState, ActionButton } from '@/components/shared'
 */

// Data state components (SYNC-08)
export { LoadingState } from './loading-state'
export { ErrorState } from './error-state'
export { EmptyState } from './empty-state'

// Loading indicator
export { LoadingSpinner } from './loading-spinner'

// Action components (SYNC-07)
export { ActionButton, type ActionButtonProps } from './action-button'

// Other shared components
export { ConfirmDialog } from './confirm-dialog'
export { DataTable } from './data-table'
export { SearchInput } from './search-input'

// Error handling
export { ErrorBoundary, PageErrorBoundary } from './error-boundary'
```

This creates a single import point for all shared components.
  </action>
  <verify>
- File exists at apps/admin/src/components/shared/index.ts
- TypeScript compiles: `cd apps/admin && npx tsc --noEmit`
- Can import: `import { LoadingState, ErrorState, ActionButton } from '@/components/shared'`
  </verify>
  <done>Shared components barrel export provides convenient access to all shared components</done>
</task>

</tasks>

<verification>
Run these commands to verify plan completion:

```bash
# 1. Verify files exist
ls -la apps/admin/src/components/shared/loading-state.tsx
ls -la apps/admin/src/components/shared/error-state.tsx
ls -la apps/admin/src/components/shared/action-button.tsx
ls -la apps/admin/src/components/shared/index.ts

# 2. Verify TypeScript compiles
cd apps/admin && npx tsc --noEmit

# 3. Check exports
grep "export" apps/admin/src/components/shared/index.ts

# 4. Verify production build
cd apps/admin && npm run build
```
</verification>

<success_criteria>
- [ ] LoadingState component exists with spinner and message
- [ ] ErrorState component exists with retry button
- [ ] ActionButton component exists with isPending prop
- [ ] Barrel export includes all shared components
- [ ] TypeScript compiles without errors
- [ ] Production build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/v1.4-04-pattern-templates/04-02-SUMMARY.md`
</output>
