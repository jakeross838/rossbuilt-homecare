---
phase: v1.4-02-query-key-unification
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - apps/admin/src/hooks/use-clients.ts
  - apps/admin/src/hooks/use-properties.ts
  - apps/admin/src/hooks/use-equipment.ts
  - apps/admin/src/hooks/use-users.ts
  - apps/admin/src/hooks/use-inspections.ts
  - apps/admin/src/hooks/use-inspectors.ts
  - apps/admin/src/hooks/use-inspection-templates.ts
  - apps/admin/src/hooks/use-checklist.ts
  - apps/admin/src/hooks/use-programs.ts
  - apps/admin/src/hooks/use-pricing.ts
  - apps/admin/src/hooks/use-organization.ts
  - apps/admin/src/hooks/use-profile.ts
  - apps/admin/src/hooks/use-property-assignments.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Core entity hooks import keys from centralized registry"
    - "No local key factory definitions in migrated hooks"
    - "All queries use centralized keys"
  artifacts:
    - path: "apps/admin/src/hooks/use-clients.ts"
      provides: "Client CRUD hooks using centralized keys"
      contains: "import { clientKeys } from '@/lib/queries'"
    - path: "apps/admin/src/hooks/use-properties.ts"
      provides: "Property CRUD hooks using centralized keys"
      contains: "import { propertyKeys } from '@/lib/queries'"
  key_links:
    - from: "apps/admin/src/hooks/use-*.ts"
      to: "apps/admin/src/lib/queries/keys.ts"
      via: "Import statement"
      pattern: "import.*Keys.*from.*@/lib/queries"
---

<objective>
Migrate core entity hooks (clients, properties, equipment, users, inspections, programs) to use centralized query keys from `@/lib/queries`.

Purpose: Remove local key definitions, establish single source of truth pattern.
Output: 13 hooks updated to import from centralized registry.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md

Plan 02-01 output:
@apps/admin/src/lib/queries/keys.ts (centralized keys)
@apps/admin/src/lib/queries/index.ts (barrel export)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate core entity hooks (clients, properties, equipment, users)</name>
  <files>
apps/admin/src/hooks/use-clients.ts
apps/admin/src/hooks/use-properties.ts
apps/admin/src/hooks/use-equipment.ts
apps/admin/src/hooks/use-users.ts
  </files>
  <action>
For each file:

1. **Remove local key factory definition:**
   - Delete the `export const xxxKeys = { ... }` block

2. **Add import from centralized registry:**
   - Add: `import { clientKeys } from '@/lib/queries'` (or propertyKeys, equipmentKeys, userKeys)

3. **Keep all hook logic unchanged:**
   - Only the import location changes
   - Query key usage remains the same

**use-clients.ts changes:**
- Remove lines ~10-20 (clientKeys definition)
- Add import: `import { clientKeys } from '@/lib/queries'`

**use-properties.ts changes:**
- Remove lines ~11-22 (propertyKeys definition)
- Add import: `import { propertyKeys, clientKeys } from '@/lib/queries'`
- Note: This file uses clientKeys for invalidation, so import both

**use-equipment.ts changes:**
- Remove lines ~9-16 (equipmentKeys definition)
- Add import: `import { equipmentKeys } from '@/lib/queries'`

**use-users.ts changes:**
- Remove lines ~9-20 (userKeys definition)
- Add import: `import { userKeys } from '@/lib/queries'`
  </action>
  <verify>
- `cd apps/admin && npx tsc --noEmit` compiles without errors
- No local key definitions remain in these files
- Grep shows imports from '@/lib/queries'
  </verify>
  <done>
- 4 core entity hooks migrated to centralized keys
- Local key definitions removed
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate inspection-related hooks</name>
  <files>
apps/admin/src/hooks/use-inspections.ts
apps/admin/src/hooks/use-inspectors.ts
apps/admin/src/hooks/use-inspection-templates.ts
apps/admin/src/hooks/use-checklist.ts
  </files>
  <action>
For each file:

**use-inspections.ts changes:**
- Remove lines ~17-28 (inspectionKeys definition)
- Add import: `import { inspectionKeys, inspectorScheduleKeys, recommendationKeys } from '@/lib/queries'`
- Update inline key usages:
  - `['calendar-inspections']` -> `inspectionKeys.calendar(...)`
  - `['property-inspections']` -> use `inspectionKeys.property(propertyId)`
  - `['inspector-workload']` -> `inspectorScheduleKeys.workload()` or keep using inspectionKeys.inspectorWorkload()

**use-inspectors.ts changes:**
- Remove lines ~8-18 (inspectorKeys definition)
- Add import: `import { inspectorKeys } from '@/lib/queries'`

**use-inspection-templates.ts changes:**
- Remove lines ~18-28 (inspectionTemplateKeys definition)
- Add import: `import { inspectionTemplateKeys } from '@/lib/queries'`

**use-checklist.ts changes:**
- Remove lines ~11-18 (checklistKeys definition)
- Add import: `import { checklistKeys } from '@/lib/queries'`
  </action>
  <verify>
- `cd apps/admin && npx tsc --noEmit` compiles without errors
- No local key definitions remain in these files
- All inline keys replaced with factory calls
  </verify>
  <done>
- 4 inspection-related hooks migrated
- Inline key strings replaced with factory calls
  </done>
</task>

<task type="auto">
  <name>Task 3: Migrate program/config hooks</name>
  <files>
apps/admin/src/hooks/use-programs.ts
apps/admin/src/hooks/use-pricing.ts
apps/admin/src/hooks/use-organization.ts
apps/admin/src/hooks/use-profile.ts
apps/admin/src/hooks/use-property-assignments.ts
  </files>
  <action>
For each file:

**use-programs.ts changes:**
- Remove lines ~16-22 (programKeys definition)
- Add import: `import { programKeys, invoiceKeys, portalKeys } from '@/lib/queries'`
- Update inline `['invoices']` -> `invoiceKeys.all`
- Update inline `['portal', 'properties']` -> `portalKeys.properties()`

**use-pricing.ts changes:**
- Remove lines ~9-14 (pricingKeys definition)
- Add import: `import { pricingKeys } from '@/lib/queries'`

**use-organization.ts changes:**
- Remove lines ~27-32 (organizationKeys definition)
- Add import: `import { organizationKeys } from '@/lib/queries'`

**use-profile.ts changes:**
- Remove lines ~8-12 (profileKeys definition)
- Add import: `import { profileKeys } from '@/lib/queries'`

**use-property-assignments.ts changes:**
- Remove lines ~7-14 (assignmentKeys definition)
- Add import: `import { assignmentKeys, userKeys } from '@/lib/queries'`
  </action>
  <verify>
- `cd apps/admin && npx tsc --noEmit` compiles without errors
- No local key definitions remain in these files
- All inline key strings replaced with factory calls
  </verify>
  <done>
- 5 program/config hooks migrated
- Cross-hook key references use centralized imports
  </done>
</task>

</tasks>

<verification>
1. TypeScript compilation: `cd apps/admin && npx tsc --noEmit`
2. Grep for local definitions: `grep -r "export const.*Keys\s*=" apps/admin/src/hooks/use-clients.ts apps/admin/src/hooks/use-properties.ts ...` should return empty
3. Grep for centralized imports: `grep -r "from '@/lib/queries'" apps/admin/src/hooks/` should show 13 files
</verification>

<success_criteria>
- [ ] 13 hooks updated with centralized imports
- [ ] No local `xxxKeys = { ... }` definitions in migrated hooks
- [ ] All inline key strings replaced with factory calls
- [ ] TypeScript compiles without errors
- [ ] App builds successfully: `npm run build`
</success_criteria>

<output>
After completion, create `.planning/phases/v1.4-02-query-key-unification/02-02-SUMMARY.md`
</output>
