---
phase: 06-smart-scheduling
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/admin/src/lib/constants/scheduling.ts
  - apps/admin/src/lib/validations/inspection.ts
  - apps/admin/src/lib/types/scheduling.ts
autonomous: true
must_haves:
  truths:
    - "Scheduling constants define time slots and visual styles"
    - "Inspection schema validates all scheduling fields"
  artifacts:
    - path: "apps/admin/src/lib/constants/scheduling.ts"
      provides: "Time slots, inspection type colors, duration defaults"
    - path: "apps/admin/src/lib/validations/inspection.ts"
      provides: "Zod schema for inspection scheduling form"
    - path: "apps/admin/src/lib/types/scheduling.ts"
      provides: "TypeScript types for calendar and scheduling"
  key_links:
    - from: "scheduling.ts constants"
      to: "inspection.ts validation"
      via: "inspection_type enum values"
---

<objective>
Create the data foundation for scheduling: constants, validation schemas, and TypeScript types.

Purpose: Establish the type-safe foundation that calendar components and hooks will build upon.
Output: Constants file, Zod validation schema, and TypeScript type definitions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Database schema reference
@supabase/migrations/001_enums.sql
@supabase/migrations/008_inspections.sql
@supabase/migrations/013_calendar_reminders.sql

# Existing patterns
@apps/admin/src/lib/constants/equipment.ts
@apps/admin/src/lib/constants/pricing.ts
@apps/admin/src/lib/validations/equipment.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create scheduling constants</name>
  <files>apps/admin/src/lib/constants/scheduling.ts</files>
  <action>
Create constants file with:

1. TIME_SLOTS array - hourly slots from 7am to 6pm for scheduling grid
   ```ts
   export const TIME_SLOTS = ['07:00', '08:00', ..., '18:00'] as const
   ```

2. INSPECTION_TYPES with labels and colors matching database enum:
   - scheduled (default) - blue
   - storm_pre - orange
   - storm_post - orange
   - arrival - green
   - departure - purple
   - special - yellow
   - initial - teal

3. INSPECTION_DURATIONS - default duration in minutes by tier:
   - visual: 30
   - functional: 60
   - comprehensive: 90
   - preventative: 120

4. CALENDAR_COLORS - color palette for calendar events (use rb-green variants and neutral grays)

5. INSPECTION_STATUS_COLORS - matching inspection_status enum:
   - scheduled: blue
   - in_progress: yellow
   - completed: green
   - cancelled: gray
   - rescheduled: orange

Follow the pattern from equipment.ts and pricing.ts for structure.
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Constants exported with type-safe inspection types, time slots, and color mappings</done>
</task>

<task type="auto">
  <name>Task 2: Create inspection validation schema</name>
  <files>apps/admin/src/lib/validations/inspection.ts</files>
  <action>
Create Zod validation schema for scheduling inspections:

```ts
import { z } from 'zod'

export const scheduleInspectionSchema = z.object({
  property_id: z.string().uuid('Please select a property'),
  program_id: z.string().uuid().optional(),
  inspector_id: z.string().uuid().optional(),
  inspection_type: z.enum(['scheduled', 'storm_pre', 'storm_post', 'arrival', 'departure', 'special', 'initial']),
  scheduled_date: z.string().min(1, 'Please select a date'),
  scheduled_time_start: z.string().optional(),
  scheduled_time_end: z.string().optional(),
  estimated_duration_minutes: z.number().min(15).max(480).optional(),
  notes: z.string().max(1000).optional(),
})

export type ScheduleInspectionInput = z.infer<typeof scheduleInspectionSchema>
```

Also create a reschedule schema that only requires date/time changes:

```ts
export const rescheduleInspectionSchema = z.object({
  scheduled_date: z.string().min(1, 'Please select a date'),
  scheduled_time_start: z.string().optional(),
  scheduled_time_end: z.string().optional(),
  inspector_id: z.string().uuid().optional(),
})

export type RescheduleInspectionInput = z.infer<typeof rescheduleInspectionSchema>
```

Follow the pattern from equipment.ts validation.
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Validation schemas exported for scheduling and rescheduling inspections</done>
</task>

<task type="auto">
  <name>Task 3: Create scheduling TypeScript types</name>
  <files>apps/admin/src/lib/types/scheduling.ts</files>
  <action>
Create TypeScript types for calendar and scheduling UI:

```ts
import type { Tables, Enums } from '@/types/database.types'

// Inspection with joined relations for calendar display
export interface CalendarInspection {
  id: string
  property_id: string
  program_id: string | null
  inspector_id: string | null
  inspection_type: string
  status: Enums<'inspection_status'> | null
  scheduled_date: string
  scheduled_time_start: string | null
  scheduled_time_end: string | null
  estimated_duration_minutes: number | null
  // Joined data
  property?: {
    id: string
    name: string
    address_line1: string
    city: string
  }
  inspector?: {
    id: string
    full_name: string | null
    email: string
  }
}

// Calendar view types
export type CalendarViewMode = 'month' | 'week' | 'day'

export interface CalendarDay {
  date: Date
  isCurrentMonth: boolean
  isToday: boolean
  inspections: CalendarInspection[]
}

export interface CalendarWeek {
  days: CalendarDay[]
}

// Inspector workload for availability display
export interface InspectorWorkload {
  inspector_id: string
  inspector_name: string
  date: string
  inspection_count: number
  total_duration_minutes: number
}

// Time slot for scheduling grid
export interface TimeSlot {
  time: string
  label: string
  inspections: CalendarInspection[]
}
```

Follow the pattern from inspection.ts types in lib/types/.
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>TypeScript types exported for calendar views and scheduling</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd apps/admin && npx tsc --noEmit` passes
- [ ] Constants file exports TIME_SLOTS, INSPECTION_TYPES, INSPECTION_DURATIONS
- [ ] Validation schema exports scheduleInspectionSchema and rescheduleInspectionSchema
- [ ] Types file exports CalendarInspection, CalendarDay, CalendarWeek, InspectorWorkload
</verification>

<success_criteria>
- All tasks completed
- TypeScript compiles without errors
- Types align with database schema from migrations
- Constants provide all needed values for UI
</success_criteria>

<output>
After completion, create `.planning/phases/06-smart-scheduling/06-01-SUMMARY.md`
</output>
