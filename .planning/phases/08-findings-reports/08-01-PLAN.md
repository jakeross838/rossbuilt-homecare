---
phase: 08-findings-reports
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/admin/src/lib/types/report.ts
  - apps/admin/src/lib/constants/report.ts
autonomous: true
must_haves:
  truths:
    - "Report types define the PDF structure"
    - "Constants define report sections and styles"
    - "Types support recommendations, photos, and findings"
  artifacts:
    - path: "apps/admin/src/lib/types/report.ts"
      provides: "TypeScript types for reports"
    - path: "apps/admin/src/lib/constants/report.ts"
      provides: "Report configuration constants"
  key_links:
    - from: "types/report.ts"
      to: "types/inspector.ts"
      via: "imports inspection types"
---

<objective>
Create data foundation for report generation with types and constants.

Purpose: Establish typed structures for PDF report generation.
Output: TypeScript types and constants for report system.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing types
@apps/admin/src/lib/types/inspector.ts
@apps/admin/src/lib/types/inspection.ts

# Database schema
@supabase/migrations/008_inspections.sql
@supabase/migrations/009_recommendations.sql
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create report TypeScript types</name>
  <files>apps/admin/src/lib/types/report.ts</files>
  <action>
Create apps/admin/src/lib/types/report.ts:

```tsx
import type { InspectorInspection, ChecklistItemFinding, WeatherConditions } from './inspector'
import type { Enums } from '@/lib/supabase'

/**
 * Report generation status
 */
export type ReportStatus = 'pending' | 'generating' | 'ready' | 'sent' | 'viewed'

/**
 * Report section types for the PDF
 */
export type ReportSectionType =
  | 'cover'
  | 'summary'
  | 'findings_overview'
  | 'section_detail'
  | 'recommendations'
  | 'photos'
  | 'weather'
  | 'footer'

/**
 * Finding summary for reports
 */
export interface ReportFindingSummary {
  total_items: number
  passed: number
  failed: number
  needs_attention: number
  urgent: number
  not_applicable: number
  completion_percentage: number
}

/**
 * Section findings for reports
 */
export interface ReportSectionFindings {
  section_id: string
  section_name: string
  items: ReportItemFinding[]
  summary: {
    total: number
    passed: number
    issues: number
  }
}

/**
 * Individual item finding for reports
 */
export interface ReportItemFinding {
  item_id: string
  label: string
  status: ChecklistItemFinding['status']
  notes?: string
  photos: string[]
  recommendation_added: boolean
}

/**
 * Recommendation for reports
 */
export interface ReportRecommendation {
  id: string
  title: string
  description: string
  priority: Enums<'priority_level'>
  category?: string
  photos: string[]
  estimated_cost_low?: number
  estimated_cost_high?: number
  ai_why_it_matters?: string
}

/**
 * Property info for report cover
 */
export interface ReportPropertyInfo {
  id: string
  name: string
  address: string
  city: string
  state: string
  zip: string
  photo_url?: string
}

/**
 * Client info for report
 */
export interface ReportClientInfo {
  id: string
  name: string
  email?: string
  phone?: string
}

/**
 * Inspector info for report
 */
export interface ReportInspectorInfo {
  id: string
  name: string
  title?: string
}

/**
 * Complete report data structure
 */
export interface InspectionReport {
  // Metadata
  id: string
  inspection_id: string
  generated_at: string
  status: ReportStatus
  report_url?: string

  // Inspection info
  inspection_date: string
  inspection_type: string
  tier: string
  duration_minutes: number

  // Participants
  property: ReportPropertyInfo
  client: ReportClientInfo
  inspector: ReportInspectorInfo

  // Overall assessment
  overall_condition: Enums<'condition_rating'> | null
  summary: string
  ai_summary?: string
  weather?: WeatherConditions

  // Findings
  findings_summary: ReportFindingSummary
  sections: ReportSectionFindings[]

  // Recommendations
  recommendations: ReportRecommendation[]

  // Photos (consolidated)
  cover_photo?: string
  all_photos: Array<{
    url: string
    caption?: string
    section?: string
    item_label?: string
  }>
}

/**
 * Report generation options
 */
export interface ReportGenerationOptions {
  include_photos: boolean
  include_recommendations: boolean
  include_ai_summary: boolean
  include_weather: boolean
  photo_quality: 'thumbnail' | 'medium' | 'full'
  page_size: 'letter' | 'a4'
}

/**
 * Report delivery options
 */
export interface ReportDeliveryOptions {
  send_email: boolean
  email_to: string[]
  email_subject?: string
  email_message?: string
}

/**
 * Report generation request
 */
export interface GenerateReportRequest {
  inspection_id: string
  options?: Partial<ReportGenerationOptions>
  delivery?: Partial<ReportDeliveryOptions>
}

/**
 * Report generation response
 */
export interface GenerateReportResponse {
  report_id: string
  report_url: string
  generated_at: string
  page_count: number
}
```
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Report types for PDF generation</done>
</task>

<task type="auto">
  <name>Task 2: Create report constants</name>
  <files>apps/admin/src/lib/constants/report.ts</files>
  <action>
Create apps/admin/src/lib/constants/report.ts:

```tsx
/**
 * Report configuration constants for Home Care OS
 */

// Ross Built brand colors for reports
export const REPORT_COLORS = {
  primary: '#1a1a1a', // Near black
  secondary: '#666666', // Gray
  accent: '#2E7D32', // Ross Built green
  success: '#22c55e',
  warning: '#f59e0b',
  danger: '#ef4444',
  urgent: '#dc2626',
  muted: '#9ca3af',
  border: '#e5e7eb',
  background: '#ffffff',
  backgroundAlt: '#f9fafb',
} as const

// Report typography
export const REPORT_FONTS = {
  heading: 'Helvetica-Bold',
  body: 'Helvetica',
  mono: 'Courier',
} as const

// Report dimensions (in points, 72 points = 1 inch)
export const REPORT_DIMENSIONS = {
  letter: { width: 612, height: 792 }, // 8.5" x 11"
  a4: { width: 595, height: 842 }, // 210mm x 297mm
  margin: {
    top: 72, // 1"
    bottom: 72,
    left: 54, // 0.75"
    right: 54,
  },
} as const

// Status colors for findings
export const FINDING_STATUS_COLORS: Record<string, { bg: string; text: string; label: string }> = {
  pass: { bg: '#dcfce7', text: '#166534', label: 'Pass' },
  fail: { bg: '#fee2e2', text: '#991b1b', label: 'Fail' },
  needs_attention: { bg: '#fef3c7', text: '#92400e', label: 'Needs Attention' },
  urgent: { bg: '#fecaca', text: '#b91c1c', label: 'Urgent' },
  na: { bg: '#f3f4f6', text: '#6b7280', label: 'N/A' },
} as const

// Priority colors for recommendations
export const PRIORITY_COLORS: Record<string, { bg: string; text: string; label: string }> = {
  low: { bg: '#e0f2fe', text: '#0369a1', label: 'Low Priority' },
  medium: { bg: '#fef3c7', text: '#92400e', label: 'Medium Priority' },
  high: { bg: '#fed7aa', text: '#c2410c', label: 'High Priority' },
  urgent: { bg: '#fecaca', text: '#b91c1c', label: 'Urgent' },
} as const

// Condition rating labels
export const CONDITION_LABELS: Record<string, { label: string; color: string }> = {
  excellent: { label: 'Excellent', color: '#16a34a' },
  good: { label: 'Good', color: '#22c55e' },
  fair: { label: 'Fair', color: '#f59e0b' },
  poor: { label: 'Poor', color: '#f97316' },
  critical: { label: 'Critical', color: '#ef4444' },
} as const

// Inspection type labels
export const INSPECTION_TYPE_LABELS: Record<string, string> = {
  scheduled: 'Scheduled Inspection',
  storm_pre: 'Pre-Storm Inspection',
  storm_post: 'Post-Storm Inspection',
  arrival: 'Arrival Inspection',
  departure: 'Departure Inspection',
  special: 'Special Inspection',
  initial: 'Initial Inspection',
} as const

// Default report options
export const DEFAULT_REPORT_OPTIONS = {
  include_photos: true,
  include_recommendations: true,
  include_ai_summary: true,
  include_weather: true,
  photo_quality: 'medium' as const,
  page_size: 'letter' as const,
} as const

// Photo size constraints for reports
export const REPORT_PHOTO_SIZES = {
  thumbnail: { width: 80, height: 60 },
  medium: { width: 200, height: 150 },
  full: { width: 400, height: 300 },
  cover: { width: 500, height: 300 },
} as const

// Report sections configuration
export const REPORT_SECTIONS = [
  { id: 'cover', name: 'Cover Page', always_include: true },
  { id: 'summary', name: 'Executive Summary', always_include: true },
  { id: 'findings_overview', name: 'Findings Overview', always_include: true },
  { id: 'section_detail', name: 'Detailed Findings', always_include: true },
  { id: 'recommendations', name: 'Recommendations', always_include: false },
  { id: 'photos', name: 'Photo Gallery', always_include: false },
  { id: 'weather', name: 'Weather Conditions', always_include: false },
] as const

// Email templates
export const REPORT_EMAIL_TEMPLATES = {
  subject: 'Your Home Inspection Report - {property_name} - {date}',
  body: `Dear {client_name},

Your inspection report for {property_name} is ready.

Inspection Date: {date}
Overall Condition: {condition}

You can view your full report by clicking the link below:
{report_url}

Thank you for choosing Ross Built Home Care.

Best regards,
The Ross Built Team`,
} as const
```
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Report constants with colors, dimensions, and templates</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd apps/admin && npx tsc --noEmit` passes
- [ ] Report types cover all data needed for PDF
- [ ] Constants include brand colors and styles
- [ ] Types align with existing inspection types
</verification>

<success_criteria>
- All tasks completed
- TypeScript compiles without errors
- Types support full report structure
- Constants provide styling configuration
</success_criteria>

<output>
After completion, create `.planning/phases/08-findings-reports/08-01-SUMMARY.md`
</output>
