---
phase: 04-programs-pricing
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified:
  - apps/admin/src/components/programs/program-builder.tsx
  - apps/admin/src/components/programs/index.ts
autonomous: true
---

<objective>
Build the Program Builder component - a 4-step wizard for creating home care programs.

Purpose: Provide an intuitive UI for configuring program frequency, tier, addons, and scheduling.
Output: ProgramBuilder component with real-time pricing calculation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Prior plan outputs:
@.planning/phases/04-programs-pricing/04-01-SUMMARY.md
@.planning/phases/04-programs-pricing/04-02-SUMMARY.md

Reference document:
@C:/Users/Jake/Downloads/home-care-os-docs/phase-04-programs-pricing.md (section 4.6)

Existing UI patterns:
@C:/Users/Jake/home-care-os/apps/admin/src/pages/properties/components/equipment-form.tsx
@C:/Users/Jake/home-care-os/apps/admin/src/components/ui/card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Program Builder component</name>
  <files>apps/admin/src/components/programs/program-builder.tsx</files>
  <action>
Create ProgramBuilder as a 4-step form wizard:

1. Props: { propertyId, clientId, propertyName, onSuccess? }

2. Use react-hook-form with zodResolver and programSchema

3. State:
   - pricing: { baseFee, tierFee, addonsFee, monthlyTotal }
   - Recalculate on form value changes using useEffect + calculateProgramPrice

4. Step 1 - Inspection Frequency (Card):
   - RadioGroup with 5 frequency options in 5-column grid
   - Each shows label, description, and price from config
   - Selected state with border-primary styling

5. Step 2 - Inspection Tier (Card):
   - RadioGroup with 4 tier options in 2-column grid
   - Each shows label, description, price badge, and first 4 includes
   - Selected tier expands to show all includes and note

6. Step 3 - Add-On Services (Card):
   - 4 Checkboxes in 2-column grid
   - Each shows label, description, price badge
   - Click anywhere on card toggles checkbox

7. Step 4 - Scheduling Preferences (Card):
   - 3-column grid: Preferred Day, Preferred Time, Preferred Inspector
   - Day: Select with DAYS_OF_WEEK options
   - Time: Select with TIME_SLOTS options
   - Inspector: Select populated from useUsers({ role: 'inspector' })

8. Pricing Summary (Card with primary/5 bg):
   - Show base fee, tier fee, addons fee, monthly total
   - Update in real-time as selections change

9. Submit section:
   - Cancel button (variant outline)
   - Activate Program button (calls createProgram.mutateAsync)
   - Show loading state during submission

Follow exact structure from phase-04-programs-pricing.md section 4.6.
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>ProgramBuilder component renders all 4 steps with real-time pricing</done>
</task>

<task type="auto">
  <name>Task 2: Create barrel export</name>
  <files>apps/admin/src/components/programs/index.ts</files>
  <action>
Create barrel export file:

```typescript
export { ProgramBuilder } from './program-builder'
```

This will be expanded in 04-04 to include ProgramStatusCard.
  </action>
  <verify>File exists and exports correctly</verify>
  <done>Barrel export created for programs components</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd apps/admin && npm run build` succeeds
- [ ] ProgramBuilder renders without errors
- [ ] All 4 steps display correctly
- [ ] Pricing updates in real-time
</verification>

<success_criteria>
- All tasks completed
- No TypeScript errors
- ProgramBuilder ready for integration
</success_criteria>

<output>
After completion, create `.planning/phases/04-programs-pricing/04-03-SUMMARY.md`
</output>
