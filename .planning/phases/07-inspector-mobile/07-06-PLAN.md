---
phase: 07-inspector-mobile
plan: 06
type: execute
wave: 3
depends_on: ["07-02", "07-04"]
files_modified:
  - apps/admin/src/components/inspector/schedule-list.tsx
  - apps/admin/src/components/inspector/inspection-checklist.tsx
  - apps/admin/src/components/inspector/finding-form.tsx
  - apps/admin/src/components/inspector/inspection-header.tsx
autonomous: true
must_haves:
  truths:
    - "Inspector sees today's schedule as a list"
    - "Inspector can navigate through checklist sections"
    - "Inspector can record pass/fail/notes for each item"
  artifacts:
    - path: "apps/admin/src/components/inspector/schedule-list.tsx"
      provides: "Daily schedule list component"
    - path: "apps/admin/src/components/inspector/inspection-checklist.tsx"
      provides: "Checklist navigation and section display"
    - path: "apps/admin/src/components/inspector/finding-form.tsx"
      provides: "Form for recording individual findings"
  key_links:
    - from: "schedule-list.tsx"
      to: "use-inspector-schedule.ts"
      via: "useInspectorDaySchedule hook"
    - from: "inspection-checklist.tsx"
      to: "use-inspection-execution.ts"
      via: "useSaveFinding hook"
---

<objective>
Create mobile-optimized UI components for inspector workflow.

Purpose: Give inspectors a touch-friendly interface to view schedule and record findings.
Output: Components optimized for mobile use during field inspections.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan outputs
@.planning/phases/07-inspector-mobile/07-02-SUMMARY.md
@.planning/phases/07-inspector-mobile/07-04-SUMMARY.md

# Types and hooks
@apps/admin/src/lib/types/inspector.ts
@apps/admin/src/hooks/use-inspector-schedule.ts
@apps/admin/src/hooks/use-inspection-execution.ts
@apps/admin/src/lib/constants/inspector.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create schedule list component</name>
  <files>apps/admin/src/components/inspector/schedule-list.tsx</files>
  <action>
Create apps/admin/src/components/inspector/schedule-list.tsx:

```tsx
import { Link } from 'react-router-dom'
import { MapPin, Clock, ChevronRight, CheckCircle2, PlayCircle } from 'lucide-react'
import { Card, CardContent } from '@/components/ui/card'
import { Badge } from '@/components/ui/badge'
import { useInspectorDaySchedule } from '@/hooks/use-inspector-schedule'
import type { InspectorInspection } from '@/lib/types/inspector'
import { cn } from '@/lib/utils'

interface ScheduleListProps {
  date: string // YYYY-MM-DD
}

export function ScheduleList({ date }: ScheduleListProps) {
  const { data: schedule, isLoading, error } = useInspectorDaySchedule(date)

  if (isLoading) {
    return (
      <div className="space-y-3 p-4">
        {[1, 2, 3].map((i) => (
          <Card key={i} className="animate-pulse">
            <CardContent className="p-4">
              <div className="h-5 bg-muted rounded w-3/4 mb-2" />
              <div className="h-4 bg-muted rounded w-1/2" />
            </CardContent>
          </Card>
        ))}
      </div>
    )
  }

  if (error) {
    return (
      <div className="p-4 text-center text-destructive">
        Failed to load schedule. Please try again.
      </div>
    )
  }

  if (!schedule?.inspections.length) {
    return (
      <div className="p-8 text-center text-muted-foreground">
        <p className="text-lg font-medium">No inspections scheduled</p>
        <p className="text-sm mt-1">Enjoy your day off!</p>
      </div>
    )
  }

  return (
    <div className="space-y-3 p-4">
      <div className="flex items-center justify-between text-sm text-muted-foreground px-1">
        <span>{schedule.inspections.length} inspection{schedule.inspections.length > 1 ? 's' : ''}</span>
        <span>{Math.round(schedule.total_estimated_minutes / 60)}h estimated</span>
      </div>

      {schedule.inspections.map((inspection) => (
        <InspectionCard key={inspection.id} inspection={inspection} />
      ))}
    </div>
  )
}

function InspectionCard({ inspection }: { inspection: InspectorInspection }) {
  const isInProgress = inspection.status === 'in_progress'
  const isCompleted = inspection.status === 'completed'

  return (
    <Link to={`/inspector/inspection/${inspection.id}`}>
      <Card
        className={cn(
          'transition-colors hover:bg-muted/50 active:bg-muted',
          isInProgress && 'border-rb-green ring-1 ring-rb-green/20'
        )}
      >
        <CardContent className="p-4">
          <div className="flex items-start justify-between gap-3">
            <div className="flex-1 min-w-0">
              {/* Property name */}
              <h3 className="font-semibold text-base truncate">
                {inspection.property?.name || 'Unknown Property'}
              </h3>

              {/* Address */}
              <div className="flex items-center gap-1.5 text-sm text-muted-foreground mt-1">
                <MapPin className="h-3.5 w-3.5 flex-shrink-0" />
                <span className="truncate">
                  {inspection.property?.city}, {inspection.property?.state}
                </span>
              </div>

              {/* Time and type */}
              <div className="flex items-center gap-3 mt-2">
                {inspection.scheduled_time_start && (
                  <div className="flex items-center gap-1 text-sm">
                    <Clock className="h-3.5 w-3.5" />
                    <span>
                      {formatTime(inspection.scheduled_time_start)}
                    </span>
                  </div>
                )}
                <Badge variant="outline" className="text-xs">
                  {inspection.inspection_type}
                </Badge>
              </div>
            </div>

            {/* Status indicator */}
            <div className="flex items-center">
              {isCompleted ? (
                <CheckCircle2 className="h-6 w-6 text-green-600" />
              ) : isInProgress ? (
                <PlayCircle className="h-6 w-6 text-rb-green" />
              ) : (
                <ChevronRight className="h-5 w-5 text-muted-foreground" />
              )}
            </div>
          </div>
        </CardContent>
      </Card>
    </Link>
  )
}

function formatTime(time: string): string {
  // time is in HH:MM:SS format
  const [hours, minutes] = time.split(':')
  const hour = parseInt(hours, 10)
  const ampm = hour >= 12 ? 'PM' : 'AM'
  const hour12 = hour % 12 || 12
  return `${hour12}:${minutes} ${ampm}`
}
```
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Schedule list component with inspection cards</done>
</task>

<task type="auto">
  <name>Task 2: Create inspection header component</name>
  <files>apps/admin/src/components/inspector/inspection-header.tsx</files>
  <action>
Create apps/admin/src/components/inspector/inspection-header.tsx:

```tsx
import { ArrowLeft, MapPin, Phone, Clock, Wifi, WifiOff } from 'lucide-react'
import { Link } from 'react-router-dom'
import { Button } from '@/components/ui/button'
import { Badge } from '@/components/ui/badge'
import { Progress } from '@/components/ui/progress'
import type { InspectorInspection } from '@/lib/types/inspector'
import { calculateInspectionProgress } from '@/hooks/use-inspection-execution'
import { useOfflineStatus } from '@/hooks/use-offline'

interface InspectionHeaderProps {
  inspection: InspectorInspection
}

export function InspectionHeader({ inspection }: InspectionHeaderProps) {
  const { isOnline } = useOfflineStatus()
  const progress = calculateInspectionProgress(inspection)

  return (
    <div className="bg-background border-b sticky top-0 z-10">
      {/* Top bar with back button and status */}
      <div className="flex items-center justify-between p-3 border-b">
        <Link to="/inspector">
          <Button variant="ghost" size="sm" className="gap-1">
            <ArrowLeft className="h-4 w-4" />
            Back
          </Button>
        </Link>

        <div className="flex items-center gap-2">
          {/* Offline indicator */}
          {isOnline ? (
            <Wifi className="h-4 w-4 text-green-600" />
          ) : (
            <Badge variant="outline" className="gap-1 text-yellow-600 border-yellow-300">
              <WifiOff className="h-3 w-3" />
              Offline
            </Badge>
          )}

          {/* Status badge */}
          <Badge
            variant={inspection.status === 'in_progress' ? 'default' : 'secondary'}
            className={inspection.status === 'in_progress' ? 'bg-rb-green' : ''}
          >
            {inspection.status === 'in_progress' ? 'In Progress' : 'Scheduled'}
          </Badge>
        </div>
      </div>

      {/* Property info */}
      <div className="p-4">
        <h1 className="font-semibold text-lg">
          {inspection.property?.name || 'Inspection'}
        </h1>

        {inspection.property && (
          <div className="flex items-start gap-1.5 text-sm text-muted-foreground mt-1">
            <MapPin className="h-4 w-4 flex-shrink-0 mt-0.5" />
            <span>
              {inspection.property.address_line1}
              {inspection.property.address_line2 && `, ${inspection.property.address_line2}`}
              <br />
              {inspection.property.city}, {inspection.property.state} {inspection.property.zip}
            </span>
          </div>
        )}

        {/* Client contact */}
        {inspection.client?.phone && (
          <a
            href={`tel:${inspection.client.phone}`}
            className="flex items-center gap-1.5 text-sm text-rb-green mt-2"
          >
            <Phone className="h-4 w-4" />
            {inspection.client.first_name} {inspection.client.last_name}: {inspection.client.phone}
          </a>
        )}

        {/* Time info */}
        {inspection.scheduled_time_start && (
          <div className="flex items-center gap-1.5 text-sm text-muted-foreground mt-2">
            <Clock className="h-4 w-4" />
            Scheduled: {formatTime(inspection.scheduled_time_start)}
            {inspection.estimated_duration_minutes && (
              <span>({inspection.estimated_duration_minutes} min)</span>
            )}
          </div>
        )}
      </div>

      {/* Progress bar */}
      {inspection.status === 'in_progress' && (
        <div className="px-4 pb-3">
          <div className="flex items-center justify-between text-sm mb-1">
            <span className="text-muted-foreground">Progress</span>
            <span className="font-medium">
              {progress.completed} / {progress.total} items ({progress.percentage}%)
            </span>
          </div>
          <Progress value={progress.percentage} className="h-2" />
        </div>
      )}
    </div>
  )
}

function formatTime(time: string): string {
  const [hours, minutes] = time.split(':')
  const hour = parseInt(hours, 10)
  const ampm = hour >= 12 ? 'PM' : 'AM'
  const hour12 = hour % 12 || 12
  return `${hour12}:${minutes} ${ampm}`
}
```
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Inspection header with property info and progress</done>
</task>

<task type="auto">
  <name>Task 3: Create finding form component</name>
  <files>apps/admin/src/components/inspector/finding-form.tsx</files>
  <action>
Create apps/admin/src/components/inspector/finding-form.tsx:

```tsx
import { useState } from 'react'
import { Check, X, AlertTriangle, AlertCircle, Minus, Camera, Loader2 } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { Textarea } from '@/components/ui/textarea'
import { Input } from '@/components/ui/input'
import { Label } from '@/components/ui/label'
import { cn } from '@/lib/utils'
import { useSaveFinding } from '@/hooks/use-inspection-execution'
import { usePhotoCapture, CameraInput } from '@/hooks/use-photo-capture'
import type { ChecklistItem, ChecklistItemFinding } from '@/lib/types/inspector'
import type { ChecklistItemFindingInput } from '@/lib/validations/inspection-execution'
import { ITEM_STATUS_OPTIONS } from '@/lib/constants/inspector'

interface FindingFormProps {
  inspectionId: string
  item: ChecklistItem
  existingFinding?: ChecklistItemFinding
  onSaved?: () => void
}

const STATUS_ICONS = {
  pass: Check,
  fail: X,
  needs_attention: AlertTriangle,
  urgent: AlertCircle,
  na: Minus,
} as const

export function FindingForm({
  inspectionId,
  item,
  existingFinding,
  onSaved,
}: FindingFormProps) {
  const [status, setStatus] = useState<ChecklistItemFindingInput['status']>(
    existingFinding?.status || 'pass'
  )
  const [notes, setNotes] = useState(existingFinding?.notes || '')
  const [numericValue, setNumericValue] = useState<number | undefined>(
    existingFinding?.numeric_value
  )
  const [response, setResponse] = useState(existingFinding?.response || '')

  const saveFinding = useSaveFinding()
  const {
    photos,
    isCapturing,
    canAddMore,
    openCamera,
    deletePhoto,
    fileInputRef,
    handleFileChange,
  } = usePhotoCapture(inspectionId, item.id)

  const handleSave = async () => {
    const finding: ChecklistItemFindingInput = {
      status,
      notes: notes || undefined,
      numeric_value: numericValue,
      response: response || undefined,
    }

    await saveFinding.mutateAsync({
      inspectionId,
      itemId: item.id,
      finding,
    })

    onSaved?.()
  }

  return (
    <div className="space-y-4 p-4">
      {/* Item info */}
      <div>
        <h3 className="font-medium">{item.label}</h3>
        {item.description && (
          <p className="text-sm text-muted-foreground mt-1">{item.description}</p>
        )}
      </div>

      {/* Status buttons - large touch targets */}
      <div className="grid grid-cols-5 gap-2">
        {ITEM_STATUS_OPTIONS.map((opt) => {
          const Icon = STATUS_ICONS[opt.value]
          const isSelected = status === opt.value

          return (
            <button
              key={opt.value}
              onClick={() => setStatus(opt.value)}
              className={cn(
                'flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-colors',
                isSelected
                  ? 'border-rb-green bg-rb-green/10'
                  : 'border-muted hover:border-muted-foreground/50'
              )}
            >
              <Icon className={cn('h-6 w-6', opt.color)} />
              <span className="text-xs mt-1">{opt.label}</span>
            </button>
          )
        })}
      </div>

      {/* Type-specific input */}
      {item.item_type === 'numeric' && (
        <div>
          <Label>Value {item.unit && `(${item.unit})`}</Label>
          <Input
            type="number"
            value={numericValue ?? ''}
            onChange={(e) => setNumericValue(e.target.value ? Number(e.target.value) : undefined)}
            min={item.min_value}
            max={item.max_value}
            placeholder={`Enter ${item.label.toLowerCase()}`}
            className="mt-1"
          />
        </div>
      )}

      {item.item_type === 'text' && (
        <div>
          <Label>Response</Label>
          <Input
            value={response}
            onChange={(e) => setResponse(e.target.value)}
            placeholder="Enter response"
            className="mt-1"
          />
        </div>
      )}

      {item.item_type === 'select' && item.options && (
        <div>
          <Label>Select Option</Label>
          <div className="grid grid-cols-2 gap-2 mt-1">
            {item.options.map((opt) => (
              <button
                key={opt}
                onClick={() => setResponse(opt)}
                className={cn(
                  'p-2 text-sm rounded-lg border transition-colors',
                  response === opt
                    ? 'border-rb-green bg-rb-green/10'
                    : 'border-muted hover:border-muted-foreground/50'
                )}
              >
                {opt}
              </button>
            ))}
          </div>
        </div>
      )}

      {/* Notes */}
      <div>
        <Label>Notes (optional)</Label>
        <Textarea
          value={notes}
          onChange={(e) => setNotes(e.target.value)}
          placeholder="Add any notes about this item..."
          rows={3}
          className="mt-1"
        />
      </div>

      {/* Photos */}
      <div>
        <div className="flex items-center justify-between mb-2">
          <Label>Photos ({photos.length}/5)</Label>
          {canAddMore && (
            <Button
              type="button"
              variant="outline"
              size="sm"
              onClick={openCamera}
              disabled={isCapturing}
              className="gap-1"
            >
              {isCapturing ? (
                <Loader2 className="h-4 w-4 animate-spin" />
              ) : (
                <Camera className="h-4 w-4" />
              )}
              Add Photo
            </Button>
          )}
        </div>

        {photos.length > 0 && (
          <div className="grid grid-cols-3 gap-2">
            {photos.map((photo) => (
              <div key={photo.id} className="relative aspect-square">
                <img
                  src={photo.previewUrl}
                  alt="Finding photo"
                  className="w-full h-full object-cover rounded-lg"
                />
                <button
                  onClick={() => deletePhoto(photo.id)}
                  className="absolute top-1 right-1 p-1 bg-black/50 rounded-full"
                >
                  <X className="h-3 w-3 text-white" />
                </button>
              </div>
            ))}
          </div>
        )}

        <CameraInput inputRef={fileInputRef} onChange={handleFileChange} />
      </div>

      {/* Save button */}
      <Button
        onClick={handleSave}
        disabled={saveFinding.isPending}
        className="w-full bg-rb-green hover:bg-rb-green/90"
        size="lg"
      >
        {saveFinding.isPending ? (
          <Loader2 className="h-4 w-4 animate-spin mr-2" />
        ) : null}
        Save Finding
      </Button>
    </div>
  )
}
```
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Finding form with status buttons, inputs, and photo capture</done>
</task>

<task type="auto">
  <name>Task 4: Create inspection checklist component</name>
  <files>apps/admin/src/components/inspector/inspection-checklist.tsx</files>
  <action>
Create apps/admin/src/components/inspector/inspection-checklist.tsx:

```tsx
import { useState } from 'react'
import { Check, ChevronRight, Circle } from 'lucide-react'
import { Card, CardContent } from '@/components/ui/card'
import { Button } from '@/components/ui/button'
import { Sheet, SheetContent, SheetHeader, SheetTitle } from '@/components/ui/sheet'
import { FindingForm } from './finding-form'
import type { InspectorInspection, ChecklistSection, ChecklistItem } from '@/lib/types/inspector'
import { cn } from '@/lib/utils'
import { ITEM_STATUS_OPTIONS } from '@/lib/constants/inspector'

interface InspectionChecklistProps {
  inspection: InspectorInspection
}

export function InspectionChecklist({ inspection }: InspectionChecklistProps) {
  const [activeSection, setActiveSection] = useState<number>(0)
  const [selectedItem, setSelectedItem] = useState<ChecklistItem | null>(null)

  const sections = inspection.checklist?.sections || []
  const findings = inspection.findings || {}

  if (!sections.length) {
    return (
      <div className="p-8 text-center text-muted-foreground">
        <p>No checklist items found for this inspection.</p>
      </div>
    )
  }

  const currentSection = sections[activeSection]

  return (
    <div className="flex flex-col h-full">
      {/* Section tabs - horizontal scroll */}
      <div className="border-b bg-muted/30">
        <div className="flex overflow-x-auto py-2 px-4 gap-2 scrollbar-hide">
          {sections.map((section, index) => {
            const sectionFindings = section.items.filter((item) => findings[item.id])
            const isComplete = sectionFindings.length === section.items.length

            return (
              <button
                key={section.id}
                onClick={() => setActiveSection(index)}
                className={cn(
                  'flex items-center gap-2 px-3 py-2 rounded-lg text-sm whitespace-nowrap transition-colors',
                  activeSection === index
                    ? 'bg-rb-green text-white'
                    : 'bg-background hover:bg-muted'
                )}
              >
                {isComplete ? (
                  <Check className="h-4 w-4" />
                ) : (
                  <span className="text-xs">
                    {sectionFindings.length}/{section.items.length}
                  </span>
                )}
                {section.title}
              </button>
            )
          })}
        </div>
      </div>

      {/* Section items */}
      <div className="flex-1 overflow-y-auto p-4">
        <div className="space-y-2">
          {currentSection.items.map((item) => {
            const finding = findings[item.id]
            const statusOption = finding
              ? ITEM_STATUS_OPTIONS.find((s) => s.value === finding.status)
              : null

            return (
              <Card
                key={item.id}
                className={cn(
                  'cursor-pointer transition-colors hover:bg-muted/50 active:bg-muted',
                  finding && 'border-l-4',
                  finding?.status === 'pass' && 'border-l-green-500',
                  finding?.status === 'fail' && 'border-l-red-500',
                  finding?.status === 'needs_attention' && 'border-l-yellow-500',
                  finding?.status === 'urgent' && 'border-l-red-600',
                  finding?.status === 'na' && 'border-l-gray-400'
                )}
                onClick={() => setSelectedItem(item)}
              >
                <CardContent className="p-3 flex items-center justify-between">
                  <div className="flex items-center gap-3">
                    {finding ? (
                      <div
                        className={cn(
                          'h-6 w-6 rounded-full flex items-center justify-center',
                          finding.status === 'pass' && 'bg-green-100 text-green-600',
                          finding.status === 'fail' && 'bg-red-100 text-red-600',
                          finding.status === 'needs_attention' && 'bg-yellow-100 text-yellow-600',
                          finding.status === 'urgent' && 'bg-red-100 text-red-600',
                          finding.status === 'na' && 'bg-gray-100 text-gray-500'
                        )}
                      >
                        <Check className="h-4 w-4" />
                      </div>
                    ) : (
                      <Circle className="h-6 w-6 text-muted-foreground" />
                    )}

                    <div>
                      <p className="font-medium text-sm">{item.label}</p>
                      {finding?.notes && (
                        <p className="text-xs text-muted-foreground truncate max-w-[200px]">
                          {finding.notes}
                        </p>
                      )}
                    </div>
                  </div>

                  <div className="flex items-center gap-2">
                    {finding && statusOption && (
                      <span className={cn('text-xs', statusOption.color)}>
                        {statusOption.label}
                      </span>
                    )}
                    <ChevronRight className="h-4 w-4 text-muted-foreground" />
                  </div>
                </CardContent>
              </Card>
            )
          })}
        </div>
      </div>

      {/* Navigation buttons */}
      <div className="border-t p-4 flex gap-2">
        <Button
          variant="outline"
          className="flex-1"
          disabled={activeSection === 0}
          onClick={() => setActiveSection(activeSection - 1)}
        >
          Previous
        </Button>
        <Button
          className="flex-1 bg-rb-green hover:bg-rb-green/90"
          disabled={activeSection === sections.length - 1}
          onClick={() => setActiveSection(activeSection + 1)}
        >
          Next Section
        </Button>
      </div>

      {/* Finding form sheet */}
      <Sheet open={!!selectedItem} onOpenChange={() => setSelectedItem(null)}>
        <SheetContent side="bottom" className="h-[85vh] rounded-t-xl">
          <SheetHeader>
            <SheetTitle>Record Finding</SheetTitle>
          </SheetHeader>
          {selectedItem && (
            <FindingForm
              inspectionId={inspection.id}
              item={selectedItem}
              existingFinding={findings[selectedItem.id]}
              onSaved={() => setSelectedItem(null)}
            />
          )}
        </SheetContent>
      </Sheet>
    </div>
  )
}
```
  </action>
  <verify>TypeScript compiles: cd apps/admin && npx tsc --noEmit</verify>
  <done>Checklist navigation with section tabs and item list</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd apps/admin && npx tsc --noEmit` passes
- [ ] Schedule list shows daily inspections
- [ ] Checklist sections are navigable
- [ ] Finding form captures all input types
- [ ] Mobile-friendly touch targets
</verification>

<success_criteria>
- All tasks completed
- TypeScript compiles without errors
- Large touch targets for mobile use
- Section navigation is intuitive
- Form handles all checklist item types
</success_criteria>

<output>
After completion, create `.planning/phases/07-inspector-mobile/07-06-SUMMARY.md`
</output>
