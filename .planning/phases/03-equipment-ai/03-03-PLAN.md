---
phase: 03-equipment-ai
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - apps/admin/src/pages/properties/components/equipment-form.tsx
  - apps/admin/src/pages/properties/components/equipment-list.tsx
  - apps/admin/src/pages/properties/components/equipment-detail-sheet.tsx
  - apps/admin/src/pages/properties/components/index.ts
autonomous: true
---

<objective>
Build the equipment UI components: form dialog, list view, and detail sheet.

Purpose: Provide the user interface for managing equipment and viewing AI-generated content.
Output: Three components ready for integration into property detail page.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Prior plan output (hooks, validation, constants):
@.planning/phases/03-equipment-ai/03-01-SUMMARY.md

Reference document with component code:
@C:/Users/Jake/Downloads/home-care-os-docs/phase-03-equipment-ai.md (sections 3.5-3.7)

Existing UI patterns:
@C:/Users/Jake/home-care-os/apps/admin/src/pages/clients/components/client-form.tsx
@C:/Users/Jake/home-care-os/apps/admin/src/components/ui/dialog.tsx
@C:/Users/Jake/home-care-os/apps/admin/src/components/ui/tabs.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create equipment form dialog</name>
  <files>apps/admin/src/pages/properties/components/equipment-form.tsx</files>
  <action>
Create EquipmentForm component as a Dialog:

1. Props: { open, onOpenChange, propertyId, equipment?: Equipment (for edit mode) }

2. Use react-hook-form with zodResolver and equipmentSchema

3. Form layout (2-column grid where appropriate):
   - Row 1: Category dropdown, Type dropdown (filtered by category)
   - Row 2: Custom Name (full width)
   - Row 3: Manufacturer, Model Number, Serial Number
   - Row 4: Install Date, Warranty Expiration
   - Row 5: Location, Serves
   - Row 6: Capacity, Filter Size, Fuel Type
   - Row 7: Notes (full width textarea)

4. Category change should:
   - Update category field
   - Clear equipment_type field
   - Update available types in Type dropdown

5. Use useCreateEquipment or useUpdateEquipment based on whether equipment prop exists

6. Show toast on success/error

7. Reset form and close dialog on success

Follow the exact structure from phase-03-equipment-ai.md section 3.6.
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>EquipmentForm dialog renders with all fields and submits correctly</done>
</task>

<task type="auto">
  <name>Task 2: Create equipment list component</name>
  <files>apps/admin/src/pages/properties/components/equipment-list.tsx</files>
  <action>
Create EquipmentList component:

1. Props: { propertyId: string }

2. Use usePropertyEquipment hook to fetch equipment

3. Header with:
   - Title "Equipment Registry"
   - Count of items
   - "Add Equipment" button that opens EquipmentForm

4. Group equipment by category using reduce()

5. For each category group, render a Card with:
   - CardHeader showing category label (from EQUIPMENT_CATEGORIES)
   - CardContent with list of equipment items

6. Each equipment item shows:
   - Name (custom_name or equipment_type)
   - Manufacturer and model number
   - "AI Ready" badge if ai_generated_at exists
   - "Generate" button if no AI content (calls useGenerateEquipmentAI)
   - Click opens EquipmentDetailSheet

7. Loading state: Loader2 spinner

8. Empty state: Card with message and "Add First Equipment" button

9. Track generatingId state for loading indicator on Generate button

Follow the exact structure from phase-03-equipment-ai.md section 3.5.
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>EquipmentList renders grouped equipment with generate/view functionality</done>
</task>

<task type="auto">
  <name>Task 3: Create equipment detail sheet</name>
  <files>apps/admin/src/pages/properties/components/equipment-detail-sheet.tsx</files>
  <action>
Create EquipmentDetailSheet component using Sheet (slide-over panel):

1. Props: { equipment, open, onOpenChange, onGenerateAI, isGenerating }

2. SheetHeader with equipment name and manufacturer/model

3. Tabs component with 4 tabs:
   - "Details" - Equipment specifications
   - "Maint." - Maintenance schedule
   - "Check" - Inspection checklists
   - "Help" - Troubleshooting guide

4. Details tab:
   - Grid showing: Serial Number, Install Date, Location, Serves, Warranty, Lifespan
   - Use date-fns format() for dates

5. Maintenance tab:
   - If no ai_generated_at: Show "Generate AI-powered maintenance schedule" with button
   - If AI content exists: List maintenance tasks as Cards with task, frequency, performer, priority badge, cost range

6. Checklist tab:
   - If no AI: Show generate prompt
   - If AI exists: Show 4 Cards (visual, functional, comprehensive, preventative) each with bulleted list

7. Troubleshoot tab:
   - If no AI: Show generate prompt
   - If AI exists: List troubleshooting items with AlertTriangle icon, symptom, cause, action

Follow the exact structure from phase-03-equipment-ai.md section 3.7.
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>EquipmentDetailSheet renders with all 4 tabs and AI content display</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd apps/admin && npm run build` succeeds
- [ ] All three components export correctly
- [ ] Components follow existing UI patterns
</verification>

<success_criteria>
- All tasks completed
- No TypeScript errors
- Components ready for integration into property page
</success_criteria>

<output>
After completion, create `.planning/phases/03-equipment-ai/03-03-SUMMARY.md`
</output>
