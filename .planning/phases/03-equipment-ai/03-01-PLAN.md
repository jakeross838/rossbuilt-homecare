---
phase: 03-equipment-ai
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/admin/src/lib/constants/equipment.ts
  - apps/admin/src/lib/validations/equipment.ts
  - apps/admin/src/hooks/use-equipment.ts
autonomous: true
---

<objective>
Create the equipment data foundation: constants, validation, and React Query hooks.

Purpose: Establish the data layer for equipment CRUD and AI generation before building UI.
Output: Constants file, Zod schema, and React Query hooks ready for UI consumption.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Database schema (equipment table exists):
@C:/Users/Jake/home-care-os/supabase/migrations/006_equipment.sql

Reference document with full specifications:
@C:/Users/Jake/Downloads/home-care-os-docs/phase-03-equipment-ai.md

Existing patterns to follow:
@C:/Users/Jake/home-care-os/apps/admin/src/lib/validations/client.ts
@C:/Users/Jake/home-care-os/apps/admin/src/hooks/use-clients.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create equipment constants</name>
  <files>apps/admin/src/lib/constants/equipment.ts</files>
  <action>
Create equipment constants file with:

1. EQUIPMENT_CATEGORIES object with 9 categories (hvac, plumbing, electrical, kitchen, laundry, pool_spa, outdoor, safety, specialty) - each with label, icon name (Lucide), and types array

2. Each category's types array contains objects with { value, label } for equipment types

3. FUEL_TYPES array: electric, natural_gas, propane, solar, na

4. COMMON_FILTER_SIZES array for HVAC filters

5. Export TypeScript types: EquipmentCategory, EquipmentType

Use the exact structure from phase-03-equipment-ai.md section 3.1.
  </action>
  <verify>TypeScript compiles without errors: `cd apps/admin && npm run build`</verify>
  <done>Constants file exports EQUIPMENT_CATEGORIES, FUEL_TYPES, COMMON_FILTER_SIZES with proper TypeScript types</done>
</task>

<task type="auto">
  <name>Task 2: Create equipment validation schema</name>
  <files>apps/admin/src/lib/validations/equipment.ts</files>
  <action>
Create Zod validation schema following the client.ts pattern:

1. equipmentSchema with fields:
   - property_id: uuid required
   - category: string required
   - equipment_type: string required
   - custom_name: string max 100 optional
   - manufacturer: string max 100 optional
   - model_number: string max 100 optional
   - serial_number: string max 100 optional
   - install_date: string optional nullable (date input)
   - warranty_expiration: string optional nullable
   - location: string max 200 optional
   - serves: string max 200 optional
   - capacity: string max 100 optional
   - filter_size: string max 50 optional
   - fuel_type: string optional
   - notes: string optional

2. Export EquipmentFormData type inferred from schema

3. Create equipmentDefaults function that returns default values for form
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>equipmentSchema, EquipmentFormData, and equipmentDefaults exported</done>
</task>

<task type="auto">
  <name>Task 3: Create equipment hooks</name>
  <files>apps/admin/src/hooks/use-equipment.ts</files>
  <action>
Create React Query hooks following use-clients.ts pattern:

1. usePropertyEquipment(propertyId: string) - List equipment for a property
   - Query key: ['equipment', 'property', propertyId]
   - Select from equipment table where property_id matches, is_active=true
   - Order by category
   - enabled: !!propertyId

2. useEquipment(id: string) - Single equipment item
   - Query key: ['equipment', id]
   - Include property info via join if needed

3. useCreateEquipment() - Create mutation
   - Invalidate ['equipment', 'property', data.property_id] on success
   - Return created equipment

4. useUpdateEquipment() - Update mutation
   - Invalidate equipment queries on success

5. useDeleteEquipment() - Soft delete (set is_active=false)
   - Invalidate queries on success

6. useGenerateEquipmentAI() - Call edge function
   - Invoke 'generate-equipment-ai' function with equipment_id
   - Invalidate equipment queries on success
   - This will be used once the edge function is deployed (Plan 03-02)
  </action>
  <verify>TypeScript compiles: `cd apps/admin && npm run build`</verify>
  <done>All 6 hooks exported and type-safe with proper query invalidation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd apps/admin && npm run build` succeeds
- [ ] All exports are properly typed
- [ ] Hook patterns match existing use-clients.ts style
</verification>

<success_criteria>
- All tasks completed
- No TypeScript errors
- Constants, validation, hooks ready for UI consumption
</success_criteria>

<output>
After completion, create `.planning/phases/03-equipment-ai/03-01-SUMMARY.md`
</output>
