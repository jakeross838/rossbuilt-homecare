# Codebase Structure

**Analysis Date:** 2026-01-19

## Directory Layout

```
home-care-os/
├── .claude/                    # Claude Code configuration
│   ├── commands/gsd/           # GSD slash commands
│   └── get-shit-done/          # GSD framework files
├── .planning/                  # Project planning docs
│   ├── codebase/               # Codebase analysis docs (this file)
│   ├── phases/                 # Phase implementation plans
│   └── research/               # Research documents
├── apps/                       # Application packages
│   └── admin/                  # Main admin + portal + inspector app
├── packages/                   # Shared packages (currently empty)
├── scripts/                    # Build/deploy scripts
├── src/                        # Root src (legacy/unused)
├── supabase/                   # Supabase configuration
│   ├── functions/              # Edge Functions
│   └── migrations/             # SQL migrations
├── package.json                # Root package.json (workspace)
└── DEPLOYMENT.md               # Deployment documentation
```

## Directory Purposes

**apps/admin/src/:**
- Purpose: Main application source code
- Contains: All React components, hooks, pages, stores
- Key files: `main.tsx`, `App.tsx`, `index.css`

**apps/admin/src/components/:**
- Purpose: Reusable React components
- Contains: UI primitives, feature components, layout components
- Organized by: Feature domain (billing, calendar, inspector, etc.) and shared (ui, shared, layout, providers)

**apps/admin/src/components/ui/:**
- Purpose: Base UI components (shadcn/ui style)
- Contains: Button, Card, Input, Form, Dialog, etc.
- Key files: All primitives like `button.tsx`, `card.tsx`, `input.tsx`

**apps/admin/src/components/shared/:**
- Purpose: App-wide shared components
- Contains: DataTable, ConfirmDialog, EmptyState, ErrorBoundary, LoadingSpinner, SearchInput
- Key files: `data-table.tsx`, `error-boundary.tsx`

**apps/admin/src/components/layout/:**
- Purpose: App layout components
- Contains: Sidebar, Header, PageHeader, AppLayout
- Key files: `app-layout.tsx`, `sidebar.tsx`, `header.tsx`

**apps/admin/src/pages/:**
- Purpose: Route page components
- Contains: One folder per route segment, components co-located
- Organized by: URL path (dashboard, clients, properties, inspector, portal, etc.)

**apps/admin/src/hooks/:**
- Purpose: Custom React hooks for data fetching and business logic
- Contains: React Query hooks for each entity type
- Key files: `use-clients.ts`, `use-properties.ts`, `use-inspections.ts`, `use-work-orders.ts`

**apps/admin/src/stores/:**
- Purpose: Zustand global state stores
- Contains: Auth store, UI store
- Key files: `auth-store.ts`, `ui-store.ts`

**apps/admin/src/lib/:**
- Purpose: Utilities, constants, and shared code
- Contains: Supabase client, validation schemas, type definitions, helpers
- Organized by: Category (constants, email, helpers, offline, pdf, storage, stripe, types, validations)

**apps/admin/src/lib/types/:**
- Purpose: Domain type definitions
- Contains: TypeScript interfaces for business domains
- Key files: `analytics.ts`, `billing.ts`, `inspection.ts`, `work-order.ts`

**apps/admin/src/lib/validations/:**
- Purpose: Zod validation schemas
- Contains: Form validation, transform functions, defaults
- Key files: `client.ts`, `property.ts`, `inspection.ts`, `work-order.ts`

**apps/admin/src/lib/constants/:**
- Purpose: Application constants and configuration
- Contains: Enums, static data, template definitions
- Key files: `equipment.ts`, `inspection-templates.ts`, `billing.ts`

**apps/admin/src/lib/offline/:**
- Purpose: IndexedDB offline storage for inspector PWA
- Contains: Database schema, cache operations, sync logic
- Key files: `db.ts`, `photos.ts`, `sync.ts`

**apps/admin/src/types/:**
- Purpose: Auto-generated Supabase types
- Contains: Database schema types
- Key files: `database.ts` (generated by `supabase gen types`)

**supabase/migrations/:**
- Purpose: SQL database migrations
- Contains: Numbered migration files
- Key files: `001_enums.sql` through `023_demo_data.sql`

**supabase/functions/:**
- Purpose: Supabase Edge Functions
- Contains: Serverless function folders
- Key folders: `create-payment-link/`, `generate-equipment-ai/`, `generate-report-summary/`, `send-email/`, `stripe-webhook/`

## Key File Locations

**Entry Points:**
- `apps/admin/src/main.tsx`: React app entry
- `apps/admin/src/App.tsx`: Router and provider setup
- `apps/admin/index.html`: HTML template

**Configuration:**
- `apps/admin/package.json`: Dependencies and scripts
- `apps/admin/vite.config.ts`: Vite build configuration
- `apps/admin/tsconfig.json`: TypeScript configuration
- `apps/admin/tailwind.config.js`: Tailwind CSS configuration
- `supabase/config.toml`: Supabase project configuration

**Core Logic:**
- `apps/admin/src/lib/supabase.ts`: Supabase client and type helpers
- `apps/admin/src/stores/auth-store.ts`: Authentication state management
- `apps/admin/src/hooks/use-realtime-sync.ts`: Real-time data synchronization

**Testing:**
- `apps/admin/e2e/`: Playwright E2E tests
- `apps/admin/playwright.config.ts`: Playwright configuration

## Naming Conventions

**Files:**
- Components: `kebab-case.tsx` (e.g., `client-form.tsx`, `data-table.tsx`)
- Hooks: `use-kebab-case.ts` (e.g., `use-clients.ts`, `use-offline.ts`)
- Types: `kebab-case.ts` (e.g., `analytics.ts`, `work-order.ts`)
- Validations: `kebab-case.ts` matching entity (e.g., `client.ts`, `property.ts`)
- Constants: `kebab-case.ts` (e.g., `equipment.ts`, `billing.ts`)

**Directories:**
- Feature components: `kebab-case/` (e.g., `calendar/`, `billing/`, `inspector/`)
- Route segments: `kebab-case/` or `[param]/` for dynamic routes (e.g., `clients/`, `[id]/`)
- Library modules: `kebab-case/` (e.g., `offline/`, `pdf/`, `validations/`)

**Exports:**
- Components: PascalCase (e.g., `ClientForm`, `DataTable`)
- Hooks: camelCase starting with "use" (e.g., `useClients`, `useCreateClient`)
- Types: PascalCase (e.g., `Client`, `Property`, `WorkOrder`)
- Constants: SCREAMING_SNAKE_CASE or camelCase objects

## Where to Add New Code

**New Feature:**
- Primary code: `apps/admin/src/pages/{feature}/` for pages
- Feature components: `apps/admin/src/components/{feature}/` with barrel export
- Data hooks: `apps/admin/src/hooks/use-{feature}.ts`
- Validation: `apps/admin/src/lib/validations/{feature}.ts`
- Types: `apps/admin/src/lib/types/{feature}.ts`
- Constants: `apps/admin/src/lib/constants/{feature}.ts`

**New Page:**
- Implementation: `apps/admin/src/pages/{route}/index.tsx`
- Sub-pages: `apps/admin/src/pages/{route}/{sub-route}.tsx`
- Page components: `apps/admin/src/pages/{route}/components/`
- Route registration: Add to `apps/admin/src/App.tsx` Routes

**New Component:**
- UI primitive: `apps/admin/src/components/ui/{component}.tsx`
- Shared component: `apps/admin/src/components/shared/{component}.tsx`
- Feature component: `apps/admin/src/components/{feature}/{component}.tsx`
- Add to barrel export: `apps/admin/src/components/{feature}/index.ts`

**New Hook:**
- Data hook: `apps/admin/src/hooks/use-{entity}.ts`
- Follow pattern: export query keys, list hook, detail hook, CRUD mutation hooks

**New Database Table:**
- Migration: `supabase/migrations/{next_number}_{description}.sql`
- Regenerate types: `npm run db:gen-types`
- Add RLS policies in migration

**Utilities:**
- Shared helpers: `apps/admin/src/lib/helpers/{domain}.ts`
- General utils: `apps/admin/src/lib/utils.ts`

## Special Directories

**apps/admin/dist/:**
- Purpose: Production build output
- Generated: Yes (by `vite build`)
- Committed: No

**apps/admin/node_modules/:**
- Purpose: NPM dependencies
- Generated: Yes (by `npm install`)
- Committed: No

**apps/admin/public/:**
- Purpose: Static assets copied to build
- Generated: No
- Committed: Yes
- Contains: `icons/`, favicon, manifest

**supabase/.temp/:**
- Purpose: Temporary Supabase CLI files
- Generated: Yes
- Committed: No

**.planning/:**
- Purpose: Project planning and documentation
- Generated: Partially (codebase docs generated)
- Committed: Yes

---

*Structure analysis: 2026-01-19*
